api_version: 1.0


id: boostsecurityio/gosec
name: Boostsecurity GoSec Scanner
namespace: boostsecurityio/gosec


config:
  require_full_repo: true
  support_diff_scan: true


steps:
  - scan:
      command:
        docker:
          image: securego/gosec:2.14.0@sha256:73858f8b1b9b7372917677151ec6deeceeaa40c5b02753080bd647dede14e213
          command: -fmt sarif -no-fail -track-suppressions .
          workdir: /app
          environment:
            HOME: /tmp/gosec
      format: sarif
      post-processor:
        run: jq 'walk(if type == "object" and has("id") and has("name") then del(.name) else . end)'
